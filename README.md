# cpt-AR (Change-point analysis with single Accumulation Rate records)

-------------------------------------------------------------------------------------
Determines zone boundaries for single influx records using the change-point analysis
as described in Finsinger et al. (2016).

In summary:

The function uses records that were previously interpolated to constant temporal resolution. It determines change points in the proxy AR record (e.g. charcoal-accumulation rates (CHAR) or pollen-accumulation rates (PAR)).

Because: 
- proxyAR (# cm-2 yr-1) = proxyConcentration (# cm-3) * sediment-accumulation rates (cm yr-1),

the sediment-accumulation rates might strongly influence proxyAR records.

To test this (somehow), the proxy.cpt() function in this script generates iteratively a number of random concentration record, calculates accumulation rates using the information from the age-depth model, and then looks at change points in the randomAR records.

The assumption is that if change points appear both in the original proxyAR and in the randomAR records, then the influence of the
sediment-accumulation rates are probably not negligible.

--
The function requires one input file with seven columns:

Column 1: CmI          =   top sample depth, interpolated

Column 2: AgeI            =   top sample age (as cal yrs BP), interpolated

Column 3: sedArI    =   sediment accumulation rate as from age-depth model (as cm year-1), interpolated

Column 4: countI           =   raw data (counts, areas, other)

Column 5: volI             =   sample volume, interpolated

Column 6: ConcI          =   concentration (as pieces cm-3), interpolated

Column 7: ArI            =   influx (or accumulation rate) value (as pieces cm-2 yr-1), interpolated


--
The function requires following parameters (which can be left at default values)

 Name      =   Site name
 
 bootstrap =   if TRUE, the random concentration record is generated by random sampling with replacement from ConcI; if FALSE
               the random numbers (rand.i) are generated with the following constrain: min(ConcI) < rand.i < max(ConcI) 
 
 q         =   number of random datasets generated 
 
 n.Q       =   the maximum number of change points
 
 n.screen  =   a change point in the random datasets is validated if it occurs in more than n.screen datasets.

By default n.screen = q * 0.025 (thus with q=1000 this equals 2.5% chance of occurrence) 

----
Run the cpt_v12_example.r script to see an example application

-------------------------------------------------------------------------------------
Suggested citation: Finsinger W., Magyari E.K., Fevre J., Orban I., Pal I., Vincze I., Hubay K,
                     Birks H.H., Braun M., Toth M.  (2016) â€“ Holocene fire regimes near the treeline
                     in the Retezat Mts. (Southern Carpathians). Quaternary International.
                     doi: 10.1016/j.quaint.2016.04.029. In press (http://dx.doi.org/10.1016/j.quaint.2016.04.029)
